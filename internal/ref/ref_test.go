package ref

import (
	"github.com/google/go-cmp/cmp"
	"regexp"
	"strings"
	"testing"
)

func TestRef_Run(t *testing.T) {
	elseiverOut := strings.Fields(`@article{Muhammed_2017,
        doi = {10.1016/j.jnca.2016.10.019},
        year = 2017,
        publisher = {Elsevier {BV}},
        volume = {78},
        pages = {267--287},
        author = {Thaha Muhammed and Riaz Ahmed Shaikh},
        title = {An analysis of fault detection strategies in wireless sensor networks},
        journal = {J.  Network  Comput. Appl.}
}`)
	elseiverOut2 := strings.Fields(`@article{Muhammed:2017:JNCA,
        doi = {10.1016/j.jnca.2016.10.019},
        year = 2017,
        publisher = {Elsevier {BV}},
        volume = {78},
        pages = {267--287},
        author = {Thaha Muhammed and Riaz Ahmed Shaikh},
        title = {An analysis of fault detection strategies in wireless sensor networks},
        journal = {Journal of Network and Computer Applications}
}`)
	elseiverOut3 := strings.Fields(`@article{Muhammed:2017:JNCA,
        doi = {10.1016/j.jnca.2016.10.019},
        year = 2017,
        publisher = {Elsevier {BV}},
        volume = {78},
        pages = {267--287},
        author = {T. Muhammed and R. A. Shaikh},
        title = {An analysis of fault detection strategies in wireless sensor networks},
        journal = {Journal of Network and Computer Applications}
}`)
	natureOut := strings.Fields(`@article{Yu:2013:NATURE,
        doi = {10.1038/nature12097},
        year = 2013,
        publisher = {Springer Science and Business Media {LLC}},
        volume = {497},
        number = {7448},
        pages = {196--197},
        author = {Shannon F. Yu and Mary K. Baylies},
        title = {Death brings new life to muscle},
        journal = {Nature}
}`)
	elseiverOut4 := strings.Fields(`@article{Muhammed_2017,
        doi = {10.1016/j.jnca.2016.10.019},
        url = {https://doi.org/10.1016%2Fj.jnca.2016.10.019},
        year = 2017,
        month = {jan},
        publisher = {Elsevier {BV}},
        volume = {78},
        pages = {267--287},
        author = {Thaha Muhammed and Riaz Ahmed Shaikh},
        title = {An analysis of fault detection strategies in wireless sensor networks},
        journal = {Journal of Network and Computer Applications}
}`)
	arXivOut := strings.Fields(`@misc{Ryan:2022:ArXiv,
  doi = {10.48550/ARXIV.2206.07772},
  author = {N. Ryan and R. Rahul},
  keywords = {Artificial Intelligence (cs.AI), FOS: Computer and information sciences, FOS: Computer and information sciences},
  title = {Deep Learning and Handheld Augmented Reality Based System for Optimal Data Collection in Fault Diagnostics Domain},
  publisher = {arXiv},
  year = {2022},
  copyright = {Creative Commons Attribution 4.0 International}
}`)
	// jsonOut := strings.Fields(`{"indexed":{"date-parts":[[2022,6,20]],"date-time":"2022-06-20T05:49:45Z","timestamp":1655704185546},"reference-count":90,"publisher":"Elsevier BV","license":[{"start":{"date-parts":[[2017,1,1]],"date-time":"2017-01-01T00:00:00Z","timestamp":1483228800000},"content-version":"tdm","delay-in-days":0,"URL":"https:\/\/www.elsevier.com\/tdm\/userlicense\/1.0\/"}],"content-domain":{"domain":["elsevier.com","sciencedirect.com"],"crossmark-restriction":true},"published-print":{"date-parts":[[2017,1]]},"DOI":"10.1016\/j.jnca.2016.10.019","type":"journal-article","created":{"date-parts":[[2016,11,1]],"date-time":"2016-11-01T21:18:22Z","timestamp":1478035102000},"page":"267-287","update-policy":"http:\/\/dx.doi.org\/10.1016\/elsevier_cm_policy","source":"Crossref","is-referenced-by-count":89,"title":"An analysis of fault detection strategies in wireless sensor networks","prefix":"10.1016","volume":"78","author":[{"given":"Thaha","family":"Muhammed","sequence":"first","affiliation":[]},{"given":"Riaz Ahmed","family":"Shaikh","sequence":"additional","affiliation":[]}],"member":"78","reference":[{"key":"10.1016\/j.jnca.2016.10.019_bib1","doi-asserted-by":"crossref","unstructured":"Abid, A., Kachouri, A., Guiloufi, A.B.F., Mahfoudhi, A., Nasri, N., Abid, M., 2015. Centralized knn anomaly detector for WSN. In: 2015 12th International Multi-Conference on Systems, Signals Devices (SSD), pp. 1\u20134. http:\/\/dx.doi.org\/10.1109\/SSD.2015.7348091","DOI":"10.1109\/SSD.2015.7348091"},{"issue":"4","key":"10.1016\/j.jnca.2016.10.019_bib2","doi-asserted-by":"crossref","first-page":"393","DOI":"10.1016\/S1389-1286(01)00302-4","article-title":"Wireless sensor networks: a survey","volume":"38","author":"Akyildiz","year":"2002","journal-title":"Comput. Netw."},{"issue":"5","key":"10.1016\/j.jnca.2016.10.019_bib3","doi-asserted-by":"crossref","first-page":"735","DOI":"10.1080\/02331887608801334","article-title":"Autoregressive series with random parameters","volume":"7","author":"Andel","year":"1976","journal-title":"Math. Operationsforschung Stat."},{"issue":"4","key":"10.1016\/j.jnca.2016.10.019_bib4","doi-asserted-by":"crossref","first-page":"495","DOI":"10.1007\/s11276-012-0480-x","article-title":"Energy-efficient and reliable data delivery in wireless sensor networks","volume":"19","author":"Anisi","year":"2013","journal-title":"Wirel. Netw."},{"key":"10.1016\/j.jnca.2016.10.019_bib5","doi-asserted-by":"crossref","unstructured":"Balzano, L., Nowak, R., 2007. Blind calibration of sensor networks. In: Proceedings of the 6th International Conference on Information Processing in Sensor Networks. IPSN-'07, ACM, Cambridge, Massachusetts, USA, pp. 79-88, http:\/\/dx.doi.org\/10.1145\/1236360.1236372","DOI":"10.1145\/1236360.1236372"},{"key":"10.1016\/j.jnca.2016.10.019_bib6","unstructured":"Banerjee, I., Chanak, P., Sikdar, B. K., Rahaman, H., 2011. DFDNM: A Distributed Fault Detection and Node Management Scheme for Wireless Sensor Network. In: Advances in Computing and Communications: First International Conference, ACC 2011, Kochi, India, July 22-24, 2011, Proceedings, Part III. Springer, pp. 68\u201381. http:\/\/dx.doi.org\/10.1007\/978-3-642-22720-2\/7"},{"key":"10.1016\/j.jnca.2016.10.019_bib7","doi-asserted-by":"crossref","unstructured":"Banerjee, I., Datta, A., Pal, S., Chatterjee, S., Samanta, T., 2014. A novel fault detection and replacement scheme in WSN. In: Thampi, S.M., Abraham, A., Pal, S.K., Rodriguez, J.M.C. (Eds.), Recent Advances in Intelligent Informatics: Proceedings of the Second International Symposium on Intelligent Informatics (ISI'13), August 23-24 2013, Mysore, India, Advances in Intelligent Systems and Computing, vol. 235. Springer International Publishing, pp. 303\u2013310. http:\/\/dx.doi.org\/10.1007\/978-3-319-01778-5_31","DOI":"10.1007\/978-3-319-01778-5_31"},{"key":"10.1016\/j.jnca.2016.10.019_bib8","doi-asserted-by":"crossref","unstructured":"Book reviews, 1988. J. Am. Stat. Assoc. 83 (403) 902\u2013926. http:\/\/dx.doi.org\/10.1080\/01621459.1988.10478680.","DOI":"10.1080\/01621459.1988.10478680"},{"key":"10.1016\/j.jnca.2016.10.019_bib9","doi-asserted-by":"crossref","unstructured":"Buonadonna, P., Gay, D., Hellerstein, J.M., Hong, W., Madden, S., 2005. Task: sensor network in a box. In: 2005 Proceedings of the Second European Workshop on Wireless Sensor Networks. IEEE, Istanbul, Turkey pp. 133\u2013144. http:\/\/dx.doi.org\/10.1109\/EWSN.2005.1462005","DOI":"10.1109\/EWSN.2005.1462005"},{"key":"10.1016\/j.jnca.2016.10.019_bib10","doi-asserted-by":"crossref","unstructured":"Bychkovskiy, V., Megerian, S., Estrin, D., Potkonjak, M., 2003. A collaborative approach to in-place sensor calibration. In:\u00a0Proceedings of the 2nd International Conference on Information Processing in Sensor Networks.\u00a0IPSN\u201903. Springer, Palo Alto, CA, USA, pp. 301\u2013316","DOI":"10.1007\/3-540-36978-3_20"},{"issue":"1","key":"10.1016\/j.jnca.2016.10.019_bib11","doi-asserted-by":"crossref","first-page":"28","DOI":"10.1080\/15501320701774675","article-title":"A sensor network architecture for tsunami detection and response","volume":"4","author":"Casey","year":"2008","journal-title":"Int. J. Distrib. Sens. Netw."},{"key":"10.1016\/j.jnca.2016.10.019_bib12","doi-asserted-by":"crossref","first-page":"307","DOI":"10.1016\/j.eswa.2015.09.040","article-title":"Fuzzy rule-based faulty node classification and management scheme for large scale wireless sensor networks","volume":"45","author":"Chanak","year":"2016","journal-title":"Expert Syst. Appl."},{"key":"10.1016\/j.jnca.2016.10.019_bib13","doi-asserted-by":"crossref","unstructured":"Chen, J., Kher, S., Somani, A., 2006. Distributed fault detection of wireless sensor networks. In: Proceedings of the 2006 Workshop on Dependability Issues in Wireless Ad Hoc Networks and Sensor Networks, DIWANS'06. ACM, New York, NY, USA, pp. 65\u201372. http:\/\/dx.doi.org\/10.1145\/1160972.1160985.","DOI":"10.1145\/1160972.1160985"},{"issue":"14","key":"10.1016\/j.jnca.2016.10.019_bib14","doi-asserted-by":"crossref","first-page":"1273","DOI":"10.1016\/S0140-3664(02)00030-0","article-title":"Crash faults identification in wireless sensor networks","volume":"25","author":"Chessa","year":"2002","journal-title":"Comput. Commun."},{"issue":"9","key":"10.1016\/j.jnca.2016.10.019_bib15","article-title":"Kolmogorov-smirnov test for rolling bearing performance degradation assessment and prognosis","volume":"17","author":"Cong","year":"2011","journal-title":"J. Vib. Control"},{"key":"10.1016\/j.jnca.2016.10.019_bib16","doi-asserted-by":"crossref","unstructured":"Dean, J., Ghemawat, S., 2008. Mapreduce: simplified data processing on large clusters, Commun. ACM 51 (1) 107\u2013113. http:\/\/dx.doi.org\/10.1145\/1327452.1327492.","DOI":"10.1145\/1327452.1327492"},{"key":"10.1016\/j.jnca.2016.10.019_bib17","doi-asserted-by":"crossref","unstructured":"Dean, J., Ghemawat, S., 2010. Mapreduce: a flexible data processing tool, Commun. ACM 53 (1) (2010) 72\u201377. http:\/\/dx.doi.org\/10.1145\/1629175.1629198.","DOI":"10.1145\/1629175.1629198"},{"key":"10.1016\/j.jnca.2016.10.019_bib18","unstructured":"Eaton, J.W., Bateman, D., Hauberg, S., 2009. GNU Octave Version 3.0.1 Manual: A High-level Interactive Language for Numerical Computations. CreateSpace Independent Publishing Platform, ISBN 1441413006. URL \u3008http:\/\/www.gnu.org\/software\/octave\/doc\/interpreter\u3009"},{"key":"10.1016\/j.jnca.2016.10.019_bib19","doi-asserted-by":"crossref","unstructured":"Fang, L., Dobson, S., 2013. Unifying sensor fault detection with energy conservation. In: Self-Organizing Systems: 7th IFIP TC 6 International Workshop, IWSOS 2013, Palma de Mallorca, Spain, May 9\u201310, Revised Selected Papers. Springer, Berlin, Heidelberg, 2014, pp. 176\u2013181. http:\/\/dx.doi.org\/10.1007\/978-3-642-54140-7_18.","DOI":"10.1007\/978-3-642-54140-7_18"},{"key":"10.1016\/j.jnca.2016.10.019_bib20","doi-asserted-by":"crossref","unstructured":"Feng, Z., Fu, J.Q., Wang, Y., 2014. Weighted distributed fault detection for wireless sensor networks based on the distance. In: 2014 33rd Chinese Control Conference (CCC). IEEE,\u00a0Nanjing, China, pp. 322\u2013326.\u00a0http:\/\/dx.doi.org\/10.1109\/ChiCC.2014.6896642","DOI":"10.1109\/ChiCC.2014.6896642"},{"issue":"3","key":"10.1016\/j.jnca.2016.10.019_bib21","doi-asserted-by":"crossref","first-page":"573","DOI":"10.1093\/biomet\/72.3.573","article-title":"A Levinson\u2013Durbin recursion for autoregressive-moving average processes","volume":"72","author":"Franke","year":"1985","journal-title":"Biometrika"},{"key":"10.1016\/j.jnca.2016.10.019_bib22","doi-asserted-by":"crossref","unstructured":"Ghorbel, O., Jmal, M.W., Abid, M., Snoussi, H., 2015. Distributed and efficient one-class outliers detection classifier in wireless sensors networks. In: Wired\/Wireless Internet Communications: 13th International Conference, WWIC 2015, Malaga, Spain, May 25\u201327. Revised Selected Papers. Springer International Publishing, Cham, 2015, pp. 259\u2013273. http:\/\/dx.doi.org\/10.1007\/978-3-319-22572-2_19.","DOI":"10.1007\/978-3-319-22572-2_19"},{"key":"10.1016\/j.jnca.2016.10.019_bib23","doi-asserted-by":"crossref","unstructured":"Guo, S., Zhang, H., Zhong, Z., Chen, J., Cao, Q., He, T., 2014. Detecting faulty nodes with data errors for wireless sensor networks. ACM Trans. Sens. Netw. 10 (3) 40\u201327. http:\/\/doi.acm.org\/10.1145\/2594773.","DOI":"10.1145\/2594773"},{"issue":"4","key":"10.1016\/j.jnca.2016.10.019_bib24","doi-asserted-by":"crossref","DOI":"10.1029\/2008WR006956","article-title":"Real-time Bayesian anomaly detection in streaming environmental data","volume":"45","author":"Hill","year":"2009","journal-title":"Water Resour. Res."},{"key":"10.1016\/j.jnca.2016.10.019_bib25","doi-asserted-by":"crossref","unstructured":"Huang, X., 2014. Distributed fault diagnosis of wireless sensor network. In: Advances in Wireless Sensor Networks: The 8th China Conference, CWSN 2014, Xi'an, China, October 31\u2013November 2. Revised Selected Papers. Springer, Berlin, Heidelberg, 2015, pp. 275\u2013283. http:\/\/dx.doi.org\/10.1007\/978-3-662-46981-1_26.","DOI":"10.1007\/978-3-662-46981-1_26"},{"key":"10.1016\/j.jnca.2016.10.019_bib26","unstructured":"Intel Lab Data. \u3008http:\/\/db.csail.mit.edu\/labdata\/labdata.html\u3009."},{"issue":"3","key":"10.1016\/j.jnca.2016.10.019_bib27","doi-asserted-by":"crossref","first-page":"829","DOI":"10.1007\/s11276-014-0820-0","article-title":"Kuiper test and autoregressive model-based approach for wireless sensor network fault diagnosis","volume":"21","author":"Jin","year":"2015","journal-title":"Wirel. Netw."},{"key":"10.1016\/j.jnca.2016.10.019_bib28","doi-asserted-by":"crossref","unstructured":"Jurdak, R., Wang, X. R., Obst, O., Valencia, P., 2011. Wireless Sensor Network Anomalies: Diagnosis and Detection Strategies. Springer Berlin Heidelberg, Berlin, Heidelberg, pp. 309\u2013325. URL http:\/\/dx.doi.org\/10.1007\/978-3-642-17931-0 12","DOI":"10.1007\/978-3-642-17931-0"},{"issue":"2","key":"10.1016\/j.jnca.2016.10.019_bib29","doi-asserted-by":"crossref","first-page":"35:1","DOI":"10.1145\/2530526","article-title":"Failure detection in wireless sensor networks","volume":"10","author":"Kamal","year":"2014","journal-title":"ACM Trans. Sens. Netw."},{"issue":"1","key":"10.1016\/j.jnca.2016.10.019_bib30","doi-asserted-by":"crossref","first-page":"439","DOI":"10.1016\/S0022-460X(03)00380-8","article-title":"Application of {KS} test in ball bearing fault diagnosis","volume":"269","author":"Kar","year":"2004","journal-title":"J. Sound Vib."},{"key":"10.1016\/j.jnca.2016.10.019_bib31","doi-asserted-by":"crossref","unstructured":"Kaur, A., Sharma, T.P., 2010. AFDEP: agreement based CH failure detection and election protocol for a WSN. In: Information and Communication Technologies: International Conference, ICT 2010, Kochi, Kerala, India, September 7\u20139, 2010. Proceedings. Springer, Berlin, Heidelberg, pp. 249\u2013257. doi:10.1007\/978-3-642-15766-0_36","DOI":"10.1007\/978-3-642-15766-0_36"},{"key":"10.1016\/j.jnca.2016.10.019_bib32","doi-asserted-by":"crossref","unstructured":"Kim, D.-J., Prabhakaran, B., 2011. Motion fault detection and isolation in body sensor networks. Pervasive Mob. Comput. 7 (6) 727\u2013745, (the Ninth Annual {IEEE} International Conference on Pervasive Computing and Communications (PerCom 2011)). http:\/\/dx.doi.org\/10.1016\/j.pmcj.2011.09.006.","DOI":"10.1016\/j.pmcj.2011.09.006"},{"issue":"1\u20133","key":"10.1016\/j.jnca.2016.10.019_bib33","doi-asserted-by":"crossref","first-page":"1","DOI":"10.1016\/S0925-2312(98)00030-7","article-title":"The self-organizing map","volume":"21","author":"Kohonen","year":"1998","journal-title":"Neurocomputing"},{"key":"10.1016\/j.jnca.2016.10.019_bib34","doi-asserted-by":"crossref","unstructured":"Kutten, S., Peleg, D., 1995. Fault-local distributed mending (extended abstract). In: Proceedings of the Fourteenth Annual ACM Symposium on Principles of Distributed Computing, PODC \u201995. ACM, New York, NY, USA, pp. 20\u201327. http:\/\/doi.acm.org\/10.1145\/224964.224967.","DOI":"10.1145\/224964.224967"},{"issue":"1","key":"10.1016\/j.jnca.2016.10.019_bib35","doi-asserted-by":"crossref","first-page":"144","DOI":"10.1006\/jagm.1998.0972","article-title":"Fault-local distributed mending","volume":"30","author":"Kutten","year":"1999","journal-title":"J. Algorithms"},{"key":"10.1016\/j.jnca.2016.10.019_bib36","unstructured":"Lam, C., 2010. Hadoop in Action, 1st edition. Manning Publications Co., Greenwich, CT, USA,"},{"issue":"8","key":"10.1016\/j.jnca.2016.10.019_bib37","doi-asserted-by":"crossref","first-page":"3703","DOI":"10.1016\/j.eswa.2013.11.034","article-title":"Probabilistic fault detector for wireless sensor network","volume":"41","author":"Lau","year":"2014","journal-title":"Expert Syst. Appl."},{"key":"10.1016\/j.jnca.2016.10.019_bib38","series-title":"Bayesian Statistics: An Introduction","author":"Lee","year":"2012"},{"issue":"4","key":"10.1016\/j.jnca.2016.10.019_bib39","doi-asserted-by":"crossref","first-page":"764","DOI":"10.1016\/j.jesp.2013.03.013","article-title":"Detecting outliers","volume":"49","author":"Leys","year":"2013","journal-title":"J. Exp. Soc. Psychol."},{"key":"10.1016\/j.jnca.2016.10.019_bib40","doi-asserted-by":"crossref","first-page":"1","DOI":"10.1137\/1.9781611970654.ch1","article-title":"Bayesian Statistics: A Review","author":"Lindley","year":"1972","journal-title":"Society for Industrial and Applied Mathematics, Ch. Bayesian Statistics a Review"},{"issue":"4","key":"10.1016\/j.jnca.2016.10.019_bib41","doi-asserted-by":"crossref","first-page":"465","DOI":"10.1007\/s11276-006-6546-x","article-title":"A robust and energy-efficient data dissemination framework for wireless sensor networks","volume":"12","author":"Liu","year":"2006","journal-title":"Wirel. Netw."},{"issue":"2","key":"10.1016\/j.jnca.2016.10.019_bib42","doi-asserted-by":"crossref","first-page":"83","DOI":"10.1111\/j.1467-9574.1970.tb00110.x","article-title":"On the Kuiper test for normality with mean and variance unknown","volume":"24","author":"Louter","year":"1970","journal-title":"Stat. Neerlandica"},{"issue":"4","key":"10.1016\/j.jnca.2016.10.019_bib43","doi-asserted-by":"crossref","first-page":"2000","DOI":"10.1109\/SURV.2013.030713.00062","article-title":"Fault diagnosis in wireless sensor networks","volume":"15","author":"Mahapatro","year":"2013","journal-title":"IEEE Commun. Surv. Tutor."},{"issue":"1","key":"10.1016\/j.jnca.2016.10.019_bib44","doi-asserted-by":"crossref","first-page":"30","DOI":"10.2478\/s13537-014-0203-8","article-title":"Online fault diagnosis of wireless sensor networks","volume":"4","author":"Mahapatro","year":"2014","journal-title":"Open Comput. Sci."},{"issue":"1","key":"10.1016\/j.jnca.2016.10.019_bib45","doi-asserted-by":"crossref","first-page":"649","DOI":"10.1007\/s11277-014-1776-1","article-title":"Choice of detection parameters on fault detection in wireless sensor networks: a multiobjective optimization approach","volume":"78","author":"Mahapatro","year":"2014","journal-title":"Wirel. Pers. Commun."},{"key":"10.1016\/j.jnca.2016.10.019_bib46","series-title":"Robust Statistics","author":"Maronna","year":"2006"},{"key":"10.1016\/j.jnca.2016.10.019_bib47","doi-asserted-by":"crossref","unstructured":"Massey Jr., F.J., 1951. The Kolmogorov\u2013Smirnov test for goodness of fit. J. Am. Stat. Assoc. 46 (253) 68\u201378. http:\/\/dx.doi.org\/10.1080\/01621459.1951.10500769.","DOI":"10.1080\/01621459.1951.10500769"},{"issue":"2","key":"10.1016\/j.jnca.2016.10.019_bib48","doi-asserted-by":"crossref","first-page":"442","DOI":"10.1016\/0005-2795(75)90109-9","article-title":"Comparison of the predicted and observed secondary structure of t4 phage lysozyme","volume":"405","author":"Matthews","year":"1975","journal-title":"Biochim. Biophys. Acta (BBA) \u2013 Protein Struct."},{"key":"10.1016\/j.jnca.2016.10.019_bib49","unstructured":"Michie, D., Spiegelhalter, D.J., Taylor, C., 1994. Machine Learning, Neural and Statistical Classification."},{"key":"10.1016\/j.jnca.2016.10.019_bib50","unstructured":"Mitchell, T.M., et al., 1997. Machine Learning."},{"key":"10.1016\/j.jnca.2016.10.019_bib51","doi-asserted-by":"crossref","first-page":"590430","DOI":"10.1155\/2015\/590430","article-title":"Passive diagnosis for WSNs using time domain features of sensing data","volume":"501","author":"Mo","year":"2015","journal-title":"Int. J. Distrib. Sens. Netw."},{"key":"10.1016\/j.jnca.2016.10.019_bib52","doi-asserted-by":"crossref","unstructured":"Nguyen, T.A., Bucur, D., Aiello, M., Tei, K., 2013. Applying time series analysis and neighbourhood voting in a decentralised approach for fault detection and classification in WSNs. In: Proceedings of the Fourth Symposium on Information and Communication Technology, SoICT \u201913. ACM, New York, NY, USA, pp. 234\u2013241. http:\/\/dx.doi.org\/10.1145\/2542050.2542080.","DOI":"10.1145\/2542050.2542080"},{"issue":"3","key":"10.1016\/j.jnca.2016.10.019_bib53","doi-asserted-by":"crossref","first-page":"23:1","DOI":"10.1145\/2240092.2240097","article-title":"Sensor network data fault detection with maximum a posteriori selection and Bayesian modeling","volume":"8","author":"Ni","year":"2012","journal-title":"ACM Trans. Sens. Netw."},{"key":"10.1016\/j.jnca.2016.10.019_bib54","doi-asserted-by":"crossref","unstructured":"Nitesh, K., Jana, P., 2015. Dfda: a distributed fault detection algorithm in two tier wireless sensor networks. In: Satapathy, S.C., Biswal, B.N., Udgata, S.K., Mandal, J.K. (Eds.), Proceedings of the 3rd International Conference on Frontiers of Intelligent Computing: Theory and Applications (FICTA) 2014,\u00a0Bhubaneswar, Odisha, India. Advances in Intelligent Systems and Computing, vol. 328. Springer International Publishing, pp. 739\u2013746","DOI":"10.1007\/978-3-319-12012-6_82"},{"key":"10.1016\/j.jnca.2016.10.019_bib55","unstructured":"Obst, O., 2009. Poster abstract: distributed fault detection using a recurrent neural network. In: International Conference on Information Processing in Sensor Networks, 2009. IPSN 2009, pp. 373\u2013374."},{"issue":"3","key":"10.1016\/j.jnca.2016.10.019_bib56","doi-asserted-by":"crossref","first-page":"261","DOI":"10.1007\/s11063-013-9327-4","article-title":"Distributed fault detection in sensor networks using a recurrent neural network","volume":"40","author":"Obst","year":"2014","journal-title":"Neural Process. Lett."},{"key":"10.1016\/j.jnca.2016.10.019_bib57","doi-asserted-by":"crossref","unstructured":"Panda, M., Khilar, P., 2012. Distributed soft fault detection algorithm in wireless sensor networks using statistical test. In: 2012 2nd IEEE International Conference on Parallel Distributed and Grid Computing (PDGC), pp. 195\u2013198. http:\/\/dx.doi.org\/10.1109\/PDGC.2012.6449816.","DOI":"10.1109\/PDGC.2012.6449816"},{"key":"10.1016\/j.jnca.2016.10.019_bib58","doi-asserted-by":"crossref","article-title":"Energy efficient distributed fault identification algorithm in wireless sensor networks","author":"Panda","year":"2014","journal-title":"J. Comput. Netw. Commun.","DOI":"10.1155\/2014\/323754"},{"key":"10.1016\/j.jnca.2016.10.019_bib59","doi-asserted-by":"crossref","first-page":"170","DOI":"10.1016\/j.adhoc.2014.10.006","article-title":"Distributed self fault diagnosis algorithm for large scale wireless sensor networks using modified three sigma edit test","volume":"25","author":"Panda","year":"2015","journal-title":"Ad Hoc Netw. Part A"},{"key":"10.1016\/j.jnca.2016.10.019_bib60","doi-asserted-by":"crossref","unstructured":"Panda, R.R., Gouda, B.S., Panigrahi, T., 2014. Efficient fault node detection algorithm for wireless sensor networks. In: 2014 International Conference on High Performance Computing and Applications (ICHPCA). IEEE,\u00a0Bhubaneswar, Odisha, India, pp. 1\u20135","DOI":"10.1109\/ICHPCA.2014.7045308"},{"issue":"2","key":"10.1016\/j.jnca.2016.10.019_bib61","doi-asserted-by":"crossref","first-page":"551","DOI":"10.1109\/SURV.2012.062612.00084","article-title":"Energy-efficient routing protocols in wireless sensor networks: a survey","volume":"15","author":"Pantazis","year":"2013","journal-title":"IEEE Commun. Surv. Tutor."},{"key":"10.1016\/j.jnca.2016.10.019_bib62","series-title":"Descriptive and Sampling Statistics","author":"Peatman","year":"1947"},{"key":"10.1016\/j.jnca.2016.10.019_bib63","unstructured":"Press, W.H., Flannery, B.P., Teukolsky, S.A., Vetterling, W.T., 1990. Numerical Recipes."},{"key":"10.1016\/j.jnca.2016.10.019_bib64","unstructured":"R Core Team, 2015. R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria. URL \u3008http:\/\/www.R-project.org\/\u3009"},{"issue":"1","key":"10.1016\/j.jnca.2016.10.019_bib65","doi-asserted-by":"crossref","first-page":"4","DOI":"10.1109\/MASSP.1986.1165342","article-title":"An introduction to hidden Markov models","volume":"3","author":"Rabiner","year":"1986","journal-title":"IEEE ASSP Mag."},{"key":"10.1016\/j.jnca.2016.10.019_bib66","unstructured":"Ramanathan, N., Balzano, L., Burt, M., Estrin, D., Harmon, T., Harvey, C., Jay, J., Kohler, E., Rothenberg, S., Srivastava, M., 2006. Rapid deployment with confidence: calibration and fault detection in environmental sensor networks. Center for Embedded Network Sensing."},{"key":"10.1016\/j.jnca.2016.10.019_bib67","doi-asserted-by":"crossref","first-page":"2","DOI":"10.1016\/j.adhoc.2012.09.002","article-title":"Design, development, and deployment of a wireless sensor network for detection of landslides","volume":"13","author":"Ramesh","year":"2014","journal-title":"Ad Hoc Netw. Part A"},{"issue":"7","key":"10.1016\/j.jnca.2016.10.019_bib68","doi-asserted-by":"crossref","first-page":"1913","DOI":"10.1007\/s11276-009-0235-5","article-title":"Statistical reliability for energy efficient data transport in wireless sensor networks","volume":"16","author":"Rosberg","year":"2010","journal-title":"Wirel. Netw."},{"issue":"2","key":"10.1016\/j.jnca.2016.10.019_bib69","doi-asserted-by":"crossref","first-page":"1571","DOI":"10.1007\/s11277-014-1836-6","article-title":"Diagnosis of wireless sensor networks in presence of permanent and intermittent faults","volume":"78","author":"Sahoo","year":"2014","journal-title":"Wirel. Pers. Commun."},{"key":"10.1016\/j.jnca.2016.10.019_bib70","doi-asserted-by":"crossref","unstructured":"Sahoo, M.N., Khilar, P.M., 2014b. Distributed diagnosis of permanent and intermittent faults in wireless sensor networks. In: Advanced Computing, Networking and Informatics\u2014Volume 2: Wireless Networks and Security Proceedings of the Second International Conference on Advanced Computing, Networking and Informatics (ICA CNI-2014). Springer International Publishing, Cham, pp. 133\u2013141. http:\/\/dx.doi.org\/10.1007\/978-3-319-07350-7_15.","DOI":"10.1007\/978-3-319-07350-7_15"},{"key":"10.1016\/j.jnca.2016.10.019_bib71","doi-asserted-by":"crossref","unstructured":"Saihi, M., Boussaid, B., Zouinkhi, A., Abdelkrim, M.N., 2013. Decentralized fault detection in wireless sensor network based on function error. In: 2013 10th International Multi-Conference on Systems, Signals & Devices (SSD). IEEE, Hammamet, Tunisia, pp. 1\u20135","DOI":"10.1109\/SSD.2013.6564159"},{"key":"10.1016\/j.jnca.2016.10.019_bib72","volume":"7","author":"Sanchez","year":"1997"},{"key":"10.1016\/j.jnca.2016.10.019_bib73","first-page":"1","article-title":"rdfd, reactive distributed fault detection in wireless sensor networks","author":"Sharma","year":"2016","journal-title":"Wirel. Netw."},{"key":"10.1016\/j.jnca.2016.10.019_bib74","doi-asserted-by":"crossref","unstructured":"Szewczyk, R., Polastre, J., Mainwaring, A., Culler, D., 2004. Lessons from a sensor network expedition. In: Karl, H., Wolisz, A., Willig, (Eds.), Wireless Sensor Networks: First European Workshop, EWSN 2004, Berlin, Germany, January 19-21, 2004. Proceedings. Springer Berlin Heidelberg, Berlin, Heidelberg, pp. 307\u2013322. http:\/\/dx.doi.org\/10.1007\/978-3-540-24606-0_21","DOI":"10.1007\/978-3-540-24606-0_21"},{"issue":"3","key":"10.1016\/j.jnca.2016.10.019_bib75","doi-asserted-by":"crossref","first-page":"1009","DOI":"10.1007\/s11277-015-2822-3","article-title":"Outlier detection approach using Bayes classifiers in wireless sensor networks","volume":"85","author":"Titouna","year":"2015","journal-title":"Wirel. Pers. Commun."},{"issue":"2","key":"10.1016\/j.jnca.2016.10.019_bib76","doi-asserted-by":"crossref","first-page":"549","DOI":"10.1007\/s11277-015-2944-7","article-title":"Fds: Fault detection scheme for wireless sensor networks","volume":"86","author":"Titouna","year":"2015","journal-title":"Wirel. Pers. Commun."},{"key":"10.1016\/j.jnca.2016.10.019_bib77","doi-asserted-by":"crossref","unstructured":"Tolle, G., Polastre, J., Szewczyk, R., Culler, D., Turner, N., Tu, K., Burgess, S., Dawson, T., Buonadonna, P., Gay, D., Hong, W., 2005. A macroscope in the redwoods. In: Proceedings of the 3rd International Conference on Embedded Networked Sensor Systems. SenSys \u201905. ACM, San Diego, California, USA, pp. 51\u201363. http:\/\/dx.doi.org\/10.1145\/1098918.1098925","DOI":"10.1145\/1098918.1098925"},{"issue":"12","key":"10.1016\/j.jnca.2016.10.019_bib78","doi-asserted-by":"crossref","first-page":"116","DOI":"10.1109\/MC.2004.261","article-title":"Vehicular mobile commerce","volume":"37","author":"Varshney","year":"2004","journal-title":"Computer"},{"issue":"11","key":"10.1016\/j.jnca.2016.10.019_bib79","first-page":"190","article-title":"A fault-event detection model using trust matrix in WSN","volume":"158","author":"Wang","year":"2013","journal-title":"Sens. Transducers J."},{"key":"10.1016\/j.jnca.2016.10.019_bib80","doi-asserted-by":"crossref","unstructured":"Warriach, E.U., Tei, K., 2013. Fault detection in wireless sensor networks: a machine learning approach. In: 2013 IEEE 16th International Conference on Computational Science and Engineering (CSE). IEEE, Sydney, NSW, Australia, pp. 758\u2013765. http:\/\/dx.doi.org\/10.1109\/CSE.2013.116","DOI":"10.1109\/CSE.2013.116"},{"key":"10.1016\/j.jnca.2016.10.019_bib81","doi-asserted-by":"crossref","unstructured":"Warriach, E.U., Aiello, M., Tei, K., 2012. A machine learning approach for identifying and classifying faults in wireless sensor network. In: 2012 IEEE 15th International Conference on Computational Science and Engineering (CSE), pp. 618\u2013625. http:\/\/dx.doi.org\/10.1109\/ICCSE.2012.90.","DOI":"10.1109\/ICCSE.2012.90"},{"key":"10.1016\/j.jnca.2016.10.019_bib82","doi-asserted-by":"crossref","unstructured":"Wu, J.Y., Duh, D.R., Wang, T.Y., Chang, L.Y., 2007. Fast and simple on-line sensor fault detection scheme for wireless sensor networks. In: Embedded and Ubiquitous Computing: International Conference, EUC 2007, Taipei, Taiwan, December 17\u201320, 2007. Proceedings. Springer, Berlin, Heidelberg, pp. 444\u2013455. http:\/\/dx.doi.org\/10.1007\/978-3-540-77092-3_39.","DOI":"10.1007\/978-3-540-77092-3_39"},{"key":"10.1016\/j.jnca.2016.10.019_bib83","doi-asserted-by":"crossref","unstructured":"Xie, Z., Quirino, T., Shyu, M.L., Chen, S.C., Chang, L., 2006. Unpcc: a novel unsupervised classification scheme for network intrusion detection. In: 18th IEEE International Conference on Tools with Artificial Intelligence, 2006. ICTAI'06. IEEE,\u00a0Arlington, VA, USA, p. 743\u2013750. http:\/\/dx.doi.org\/10.1109\/ICTAI.2006.115","DOI":"10.1109\/ICTAI.2006.115"},{"key":"10.1016\/j.jnca.2016.10.019_bib84","first-page":"10","article-title":"LEDfd","volume":"2014","author":"Xu","year":"2014","journal-title":"Int. J. Distrib. Sens. Netw."},{"issue":"2","key":"10.1016\/j.jnca.2016.10.019_bib85","doi-asserted-by":"crossref","first-page":"33:1","DOI":"10.1145\/2661639","article-title":"Power-based diagnosis of node silence in remote high-end sensing systems","volume":"11","author":"Yang","year":"2014","journal-title":"ACM Trans. Sens. Netw."},{"issue":"2","key":"10.1016\/j.jnca.2016.10.019_bib86","doi-asserted-by":"crossref","first-page":"329","DOI":"10.1109\/TPDS.2013.2295810","article-title":"A time efficient approach for detecting errors in big sensor data on cloud","volume":"26","author":"Yang","year":"2015","journal-title":"IEEE Trans. Parallel Distrib. Syst."},{"issue":"6","key":"10.1016\/j.jnca.2016.10.019_bib87","doi-asserted-by":"crossref","first-page":"13","DOI":"10.1109\/MWC.2007.4407222","article-title":"Fault management in wireless sensor networks","volume":"14","author":"Yu","year":"2007","journal-title":"IEEE Wirel. Commun."},{"key":"10.1016\/j.jnca.2016.10.019_bib88","doi-asserted-by":"crossref","unstructured":"Yuan, H., Zhao, X., Yu, L., 2015. A distributed Bayesian algorithm for data fault detection in wireless sensor networks. In: 2015 International Conference on Information Networking (ICOIN). IEEE,\u00a0Cambodia, pp. 63\u201368. http:\/\/dx.doi.org\/10.1109\/ICOIN.2015.7057858","DOI":"10.1109\/ICOIN.2015.7057858"},{"key":"10.1016\/j.jnca.2016.10.019_bib89","first-page":"1","article-title":"Fault detection and recovery scheme for routing and lifetime enhancement in wsn","author":"Yuvaraja","year":"2015","journal-title":"Wirel. Netw."},{"issue":"2","key":"10.1016\/j.jnca.2016.10.019_bib90","first-page":"3","article-title":"The optimality of Naive Bayes","volume":"1","author":"Zhang","year":"2004","journal-title":"AA"}],"container-title":"Journal of Network and Computer Applications","original-title":[],"language":"en","link":[{"URL":"https:\/\/api.elsevier.com\/content\/article\/PII:S1084804516302545?httpAccept=text\/plain","content-type":"text\/plain","content-version":"vor","intended-application":"text-mining"},{"URL":"https:\/\/api.elsevier.com\/content\/article\/PII:S1084804516302545?httpAccept=text\/xml","content-type":"text\/xml","content-version":"vor","intended-application":"text-mining"}],"deposited":{"date-parts":[[2019,9,15]],"date-time":"2019-09-15T02:09:52Z","timestamp":1568513392000},"score":1,"resource":{"primary":{"URL":"https:\/\/linkinghub.elsevier.com\/retrieve\/pii\/S1084804516302545"}},"subtitle":[],"short-title":[],"issued":{"date-parts":[[2017,1]]},"references-count":90,"alternative-id":["S1084804516302545"],"URL":"http:\/\/dx.doi.org\/10.1016\/j.jnca.2016.10.019","relation":{},"ISSN":["1084-8045"],"subject":["Computer Networks and Communications","Computer Science Applications","Hardware and Architecture"],"container-title-short":"Journal of Network and Computer Applications","published":{"date-parts":[[2017,1]]},"assertion":[{"value":"Elsevier","name":"publisher","label":"This article is maintained by"},{"value":"An analysis of fault detection strategies in wireless sensor networks","name":"articletitle","label":"Article Title"},{"value":"Journal of Network and Computer Applications","name":"journaltitle","label":"Journal Title"},{"value":"https:\/\/doi.org\/10.1016\/j.jnca.2016.10.019","name":"articlelink","label":"CrossRef DOI link to publisher maintained version"},{"value":"article","name":"content_type","label":"Content Type"},{"value":"\u00a9 2016 Elsevier Ltd. All rights reserved.","name":"copyright","label":"Copyright"}]}`)
	tests := []struct {
		name  string
		query []string
		flags Ref
		want  []string
	}{
		{"Valid DOI", []string{"10.1038/nature12097"},
			Ref{false, true, true, false, true, "bibtex"},
			natureOut},
		{"Invalid DOI", []string{"10.1/nat97"},
			Ref{false, true, true, false, false, "bibtex"},
			strings.Fields("")},
		{"Invalid DOI/Name", []string{"The absolute wonderful things"},
			Ref{false, true, true, false, false, "bibtex"},
			strings.Fields("")},
		{"Ef1", []string{"10.1016/j.jnca.2016.10.019"},
			Ref{false, true, true, false, false, "bibtex"},
			elseiverOut2},
		{"Ef2", []string{"10.1016/j.jnca.2016.10.019"},
			Ref{false, true, false, false, false, "bibtex"},
			elseiverOut3},
		{"Ef3", []string{"10.1016/j.jnca.2016.10.019"},
			Ref{true, false, true, true, false, "bibtex"},
			elseiverOut},
		{"Ef4", []string{"10.1016/j.jnca.2016.10.019"},
			Ref{true, true, true, true, false, "bibtex"},
			elseiverOut4},
		{"Ef5", []string{"10.1016/j.jnca.2016.10.019"},
			Ref{true, true, true, false, false, "bibtex"},
			elseiverOut4},
		{"Ef6", []string{"10.1016/j.jnca.2016.10.019"},
			Ref{true, true, true, false, false, "text"},
			strings.Fields("")},
		/*{"Ef7", []string{"10.1016/j.jnca.2016.10.019"},
		Ref{false, true, true, false, false, "json"},
		jsonOut},*/
		{"Ef8", []string{"10.48550/ARXIV.2206.07772"},
			Ref{false, false, false, false, false, "bibtex"},
			arXivOut},
	}
	for _, tc := range tests {
		ref := tc.flags
		got, _ := ref.Run(tc.query)
		diff := cmp.Diff(tc.want, strings.Fields(got))
		if diff != "" {
			t.Logf(tc.name)
			t.Fatalf(diff)
		}
	}
}

func BenchmarkLoopingName(b *testing.B) {
	authors := []string{"Thaha Mohammed ", "Riaz Ahmed Sheikh ", "Timothy Anthony Wellington "}
	for i := 0; i < b.N; i++ {
		var newAuthor strings.Builder
		newAuthor.Grow(100)
		// r2 := regexp.MustCompile(`^\s*([\p{Lu}\\{}])[\p{L}-.'\\{}]+,?[\t\v ]+((?:[\p{L}-.'\\{}]*[\t \v]*)+)?$`)
		for i := 0; i < len(authors); i++ {
			author := strings.Split(strings.TrimSpace(authors[i]), " ")
			newAuthor.Reset()
			for j := 0; j < len(author)-1; j++ {
				newAuthor.WriteString(author[j][0:1])
				newAuthor.WriteString(". ")
			}
			authors[i] = newAuthor.String() + author[len(author)-1] // r2.ReplaceAllString(authors[i], "$1. $2")
		}
	}
}
func BenchmarkRegexName(b *testing.B) {
	authors := []string{"Thaha Mohammed ", "Riaz Ahmed Sheikh ", "Timothy Anthony Wellington "}
	for i := 0; i < b.N; i++ {
		r2 := regexp.MustCompile(`^\s*([\p{Lu}\\{}])[\p{L}-.'\\{}]+,?[\t\v ]+((?:[\p{L}-.'\\{}]*[\t \v]*)+)?$`)
		for j := 0; j < len(authors); j++ {
			authors[j] = r2.ReplaceAllString(authors[j], "$1. $2")
		}
	}
}
